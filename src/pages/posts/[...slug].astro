---
import { getCollection } from "astro:content";
import BaseLayout from "@src/layouts/BaseLayout.astro";
import MarkdownEntry from "@src/components/MarkdownEntry.astro";
import HomepageLink from "@src/components/HomepageLink.astro";
import PageHeading from "@src/components/PageHeading.astro";

export async function getStaticPaths() {
  const blogEntries = (await getCollection("posts")) || [];
  return blogEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { title, date, description } = entry.data;
const formattedDate = date.toLocaleDateString("en-GB", { dateStyle: "long" });
---

<BaseLayout {title} {description}>
  <div class="max-w-2xl mx-auto">
    <HomepageLink />
    <article>
      <PageHeading>{title}</PageHeading>
      <p class="text-xl text-stone-500">{formattedDate}</p>
      <MarkdownEntry {entry} />
    </article>
  </div>
</BaseLayout>
